{% extends 'base.html' %}
{% load static %}
{% block main %}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js' %}"></script>
<!-- Select2 CSS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<!-- jQuery (Select2 نیاز دارد) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
    }
    .container {
        padding: 20px;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        max-width: 1000px;
        margin: 50px auto;
        box-sizing: border-box;
    }
    form {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }
    .form-row {
        display: flex;
        align-items: center;
        gap: 20px;
        width: 100%;
        box-sizing: border-box;
    }
    .form-row label {
        flex: 1;
        font-weight: bold;
        margin-right: 5px;
    }
    .form-row input, .form-row select {
        flex: 2;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 16px;
    }
    /* دکمه‌ها در یک خط */
    .action-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
        justify-content: space-between;
        flex-wrap: wrap;
    }
    button {
        padding: 12px 24px;
        border: none;
        border-radius: 4px;
        color: #fff;
        font-size: 16px;
        cursor: pointer;
        flex: 1;
        min-width: 150px;
    }
    .add-food-button { background-color: green; }
    .delete-button { background-color: red; }
    .report-button { background-color: #007bff; }
    .user-button { background-color: orange; }

    select, .bootstrap-datetimepicker-widget {
        z-index: 2000 !important;
        background-color: #fff !important;
        color: #000 !important;
    }
</style>

<div class="container">
    <!-- فرم اضافه کردن غذا -->
    <form method="post" action="{% url 'add_food' %}">
        {% csrf_token %}

        {% for i in "1234567" %}
        <div class="form-row">
            <label for="food{{i}}">غذا:</label>
            <input type="text" id="food{{i}}" name="food{{i}}" placeholder="نام غذا را وارد کنید" required>

            <label for="day{{i}}">روز:</label>
            <select id="day{{i}}" name="day{{i}}">
                <option value="Sat" {% if i == "1" %}selected{% endif %}>شنبه</option>
                <option value="Sun" {% if i == "2" %}selected{% endif %}>یکشنبه</option>
                <option value="Mon" {% if i == "3" %}selected{% endif %}>دوشنبه</option>
                <option value="Tue" {% if i == "4" %}selected{% endif %}>سه‌شنبه</option>
                <option value="Wed" {% if i == "5" %}selected{% endif %}>چهارشنبه</option>
                <option value="Thu" {% if i == "6" %}selected{% endif %}>پنجشنبه</option>
                <option value="Fri" {% if i == "7" %}selected{% endif %}>جمعه</option>
            </select>

            <label for="date{{i}}">تاریخ دقیق:</label>
            <input type="text" class="form-control datetimepicker-input" id="date{{i}}" name="date{{i}}" data-toggle="datetimepicker" data-target="#date{{i}}" placeholder="تاریخ را انتخاب کنید" required>
        </div>
        {% endfor %}

        <!-- بخش قیمت گروهی -->
        <div class="form-row">
            <label for="group1">گروه:</label>
            <select id="group1" name="group1">
                {% for g in groups %}
                    <option value="{{ g }}">{{ g }}</option>
                {% endfor %}
            </select>

            <label for="group_price1">قیمت برای گروه:</label>
            <input type="number" id="group_price1" name="group_price1" placeholder="قیمت را وارد کنید">
        </div>

        <!-- دکمه ثبت فرم غذا -->
        <div style="margin-top:20px;">
            <button type="submit" class="add-food-button">ثبت</button>
        </div>
    </form>

    <!-- دکمه‌های مدیریتی در یک div جداگانه -->
    <div class="action-buttons">
        <form action="{% url 'admin_report' %}">
            <button type="submit" class="report-button">تهیه گزارش</button>
        </form>
        <form method="post" action="{% url 'delete_all_foods' %}">
            {% csrf_token %}
            <button type="submit" class="delete-button" onclick="return confirmDeletion()">حذف همه</button>
        </form>
        <form action="{% url 'add_user' %}">
            <button type="submit" class="user-button">مدیریت کاربرها و گروه ها</button>
        </form>
    </div>
</div>

<script>
function confirmDeletion() {
    return confirm("آیا مطمئن هستید که می‌خواهید تمام غذاها را حذف کنید؟");
}

$(function () {
    {% for i in "1234567" %}
    $('#date{{i}}').datetimepicker({ format: 'YYYY-MM-DD' });
    {% endfor %}
});

$(document).ready(function() {
    $('.select2').select2({
        width: 'resolve'  // اندازه باکس را با container هماهنگ می‌کند
    });
});

</script>

{% endblock %}
